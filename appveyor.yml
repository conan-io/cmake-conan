build: false
image: Visual Studio 2017

environment:
  PYTHON: "C:\\Python37"
  PYTHON_VERSION: "3.7.5"
  PYTHON_ARCH: "32"

install:
  - iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))
  - set PATH=%PYTHON%/Scripts/;%PYTHON%;%PATH%
  - pip.exe install conan nose
  - conan config set general.revisions_enabled=1
  - conan install cmake/3.16.4@ -g=virtualrunenv
  - sleep 600

test_script:
  - activate_run.bat
  - cmake --version
  - nosetests . -A "not cmake39"
  - deactivate_run.bat
  - nosetests . -A "cmake39"
